<html>
<head>
    <!-- {CopyrightYears} -->
    <!-- TODO: high-res photos -->
    <!-- Ignored: notes, submissions, followings, likes, members -->
    <title>{Title}{block:PostSummary} - {PostSummary}{/block:PostSummary}</title>
    <link rel="shortcut icon" href="{Favicon}">
    <link rel="alternate" type="application/rss+xml" href="{RSS}">
    {block:Description}<meta name="description" content="{MetaDescription}"/>{/block:Description}
    <style>
        /* http://www.cssreset.com/scripts/html5-doctor-css-reset-stylesheet/ */
        html, body, div, span, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, abbr, address, cite, code, del, dfn, em, img, ins, kbd, q, samp, small, strong, sub, sup, var, b, i, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, figcaption, figure, footer, header, hgroup, menu, nav, section, summary, time, mark, audio, video { margin: 0; padding: 0; border: 0; outline: 0; font-size: 100%; vertical-align: baseline; background: transparent }
        article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section { display: block }
        nav ul { list-style: none }
        blockquote, q { quotes: none }
        blockquote:before, blockquote:after, q:before, q:after { content: none }
        a { margin: 0; padding: 0; font-size: 100%; vertical-align: baseline; background: transparent }
        ins { background-color: #ff9; color: #000; text-decoration: none }
        mark { background-color: #ff9; color: #000; font-style: italic; font-weight: bold }
        del { text-decoration: line-through }
        abbr[title], dfn[title] { border-bottom: 1px dotted; cursor: help }
        table { border-collapse: collapse; border-spacing: 0 }
        hr { display: block; height: 1px; border: 0; border-top: 1px solid #ccc; margin: 1em 0; padding: 0 }
        input, select { vertical-align: middle }

        /* YEAH */
        body {
            font-family: verdana, arial, sans-serif; font-size: 16px; line-height: 1.4em;
            background-color: #f0f0f0;
        }

        #blog { max-width: 540px; margin: 0 auto; }
        #blog > header, #blog > footer, #blog > article, #blog > section { margin-bottom: 10px; padding: 20px; }
        #blog > footer { text-align: center; }

        article img { max-width: 100%; }
        article > h3, article > section, article > figure,
        article > blockquote, article > ul, header h1 { margin-bottom: 15px; }

        h1 { font-size: 150%; }
        h1 a { text-decoration: none; }
        p, ul, ol, blockquote, li { margin-bottom: 10px; }
        ul, ol { padding-left: 1.8em; }
        figcaption, nav, blockquote footer { margin-top: 15px; }
        blockquote { padding-left: 15px; border-left: 3px solid lightgray; }
        a { color: #000; }
        a:hover { color: #d40000; }

        .meta a { color: #666; text-decoration: none; text-transform: lowercase; }
        .meta a:hover { color: #d40000; }
        .pagination { font-size: 85%; }
        .pagination a, .pagination span { padding: 10px; }
        .post .meta { font-size: 85%; }
        .post .meta section:last-child { margin-top: 5px; }
        .bracket a:before { content: '['; }
        .bracket a:after { content: ']'; }
        .like_button, .reblog_button { float: right; margin-right: 5px; }
        {CustomCSS}
    </style>
</head>
<body id="blog">
<header>
    {block:ShowTitle}<h1><a href="{BlogURL}">{Title}</a></h1>{/block:ShowTitle}
    {block:ShowDescription}{block:Description}<section>{Description}</section>{/block:Description}{/block:ShowDescription}
    <nav class="meta bracket">
        <a href="/archive">Archive</a>
        {block:AskEnabled}<a href="/ask">{AskLabel}</a>{/block:AskEnabled}
        {block:SubmissionsEnabled}<a href="/submit">{SubmitLabel}</a>{/block:SubmissionsEnabled}
        {block:HasPages}{block:Pages}
        <a href="{URL}">{Label}</a>
        {/block:Pages}{/block:HasPages}
    </nav>
</header>
{block:TagPage}<section><h2>{lang:Posts tagged Tag 3}</h2></section>{/block:TagPage}

{block:Posts}
<article class="post {PostType}">
    {block:Text}
    <!-- Text -->
    {block:Title}<h3>{Title}</h3>{/block:Title}
    <section>{Body}</section>
    {/block:Text}

    {block:Photo}
    <!-- Photo -->
    <figure>
        {block:LinkURL}<a href="{LinkURL}">{/block:LinkURL}
        <img src="{PhotoURL-500}" alt="{PhotoAlt}" width="{PhotoWidth-500}" height="{PhotoHeight-500}" />
        {block:LinkURL}</a>{/block:LinkURL}
        {block:Caption}<figcaption>{Caption}</figcaption>{/block:Caption}
    </figure>
    {/block:Photo}

    {block:Photoset}
    <!-- Photoset -->
    <figure>
        {Photoset}
        {block:Caption}<figcaption>{Caption}</figcaption>{/block:Caption}
    </figure>
    {/block:Photoset}

    {block:Quote}
    <!-- Quote -->
    <blockquote>
        {Quote}
        {block:Source}<footer>&mdash; <cite>{Source}</cite></footer>{/block:Source}
    </blockquote>
    {/block:Quote}

    {block:Link}
    <!-- Link -->
    <h3><a href="{URL}" {Target}>{Name}</a></h3>
    {block:Description}<section>{Description}</section>{/block:Description}
    {/block:Link}

    {block:Chat}
    <!-- Chat -->
    {block:Title}<h3>{Title}</h3>{/block:Title}
    <ul>
        {block:Lines}<li class="{Alt}">{block:Label}<strong>{Label}</strong>{/block:Label} {Line}</li>{/block:Lines}
    </ul>
    {/block:Chat}

    {block:Video}
    <!-- Video -->
    <figure>
        {Video-500}
        {block:Caption}<figcaption>{Caption}</figcaption>{/block:Caption}
    </figure>
    {/block:Video}

    {block:Audio}
    <!-- Audio -->
    <figure>
        {AudioEmbed}
        {block:Caption}<figcaption>{Caption}</figcaption>{/block:Caption}
    </figure>
    {/block:Audio}

    {block:Answer}
    <!-- Answer -->
    <section><strong>{lang:Asker asked 2}</strong>: <q>{Question}</q></section>
    <section>
        {block:Answerer}
        <p><strong>{Answerer}</strong>:</p><blockquote>{Answer}</blockquote>
        {/block:Answerer}
    </section>
    <section>{Replies}</section>
    {/block:Answer}

    {block:Date}
    <footer class="meta">
        <section>
            {block:RebloggedFrom}
            [<a href="{ReblogParentURL}" title="{ReblogParentTitle}">{ReblogParentName}</a>]
            <!--[<a href="{ReblogRootURL}">{ReblogRootName}</a>]-->
            {/block:RebloggedFrom}
            {block:ContentSource}(<a href="{SourceURL}">{lang:Source}: {SourceTitle}</a>){/block:ContentSource}
            {block:HasTags}{block:Tags}<a href="{TagURL}">#{Tag}</a> {/block:Tags}{/block:HasTags}
        </section>
        <section>
            {block:NoteCount}<a href="{Permalink}"><strong>{NoteCountWithLabel}</strong></a>{/block:NoteCount}
            <a href="{Permalink}">
                <time title="{Year}-{MonthNumberWithZero}-{DayOfMonthWithZero}T{24HourWithZero}:{Minutes}:{Seconds}Z">
                    {TimeAgo}
                </time>
            </a>
            {LikeButton}
            {ReblogButton}
        </section>
    </footer>
    {/block:Date}
</article>
{/block:Posts}

<footer class="pagination meta">
    {block:Pagination}{block:PreviousPage}<a id="prev" href="{PreviousPage}">&#171; {lang:Newer}</a>{/block:PreviousPage}
    {block:JumpPagination length="7"}{block:CurrentPage}<span><strong>{PageNumber}</strong></span>{/block:CurrentPage}{block:JumpPage}<a href="{URL}">{PageNumber}</a>{/block:JumpPage}{/block:JumpPagination}
    {block:NextPage}<a id="next" href="{NextPage}">{lang:Older} &#187;</a>{/block:NextPage}{/block:Pagination}

    {block:PermalinkPagination}
    {block:NextPost}<a id="prev" href="{NextPost}">&#171; {lang:Newer}</a>{/block:NextPost}
    {block:PreviousPost}<a id="next" href="{PreviousPost}">{lang:Older} &#187;</a>{/block:PreviousPost}
    {/block:PermalinkPagination}
</footer>
<script>
    // Use onkeyup because this is a heavy decision
    window.onkeyup = function (e) {
        switch (e.keyCode) {
            case 37: // left
                var p = document.getElementById('prev');
                if (p) window.location.href = p.href;
                break;
            case 39: // right
                var n = document.getElementById('next');
                if (n) window.location.href = n.href;
                break;
        }
    }
    var items = document.getElementsByTagName('article'), len = items.length;
    // Use onkeydown so we can hold and keep scrolling
    window.onkeydown = function (e) {
        switch (e.keyCode) {
            case 74: // j
                jump(true);
                break;
            case 75: // k
                jump(false);
                break;
        }
    }
    function jump(down) {
        for (var i = 0; i < len; i++) { // first to last, order important
            var el = items[i], last = i == len - 1;
            // Stupid IE 11 gives a rectangle with fractional top: 0.233...
            var top = Math.floor(el.getBoundingClientRect().top);
            if (down) {
                if (top > 0) {
                    el.scrollIntoView();
                    break;
                }
                if (last) {
                    window.scrollTo(0, document.body.scrollHeight); // to page bottom
                    break;
                }
            } else { // up
                if (top >= 0) {
                    if (i > 0) {
                        items[i - 1].scrollIntoView(); // to previous
                    } else {
                        window.scrollTo(0, 0); // to page top
                    }
                    break;
                } else if (last) {
                    items[len - 1].scrollIntoView();
                }
            }
        }
    }
</script>
</body>
